
# Updated to match test structure, preserving prod-specific values
global:
  ingressSuffix: .apps.silver.devops.gov.bc.ca
  security:
    allowInsecureImages: true

vc-authn-oidc:
  image:
    registry: ghcr.io
    repository: bcgov/acapy-vc-authn-oidc
    pullPolicy: IfNotPresent

  acapyTenancyMode: single
  setNonRevoked: true
  invitationLabel: BC Gov SSO Service
  useOobLocalDIDService: false

  controller:
    cameraRedirectUrl: wallet_howto
    presentationExpireTime: 300
    sessionTimeout:
      duration: 86400
      config:
        - expired
        - failed
        - abandoned
        - not_started
        - pending
        - verified
    templateDirectory: /app/templates
    useConnectionBasedVerification: true

  useHTTPS: true
  logLevel: INFO

  auth:
    api:
      existingSecret: "vc-authn-oidc-api-key"
    token:
      privateKey:
        existingSecret: "vc-authn-oidc-jwt-token"

  database:
    existingSecret: "vc-authn-oidc-mongodb"

  resources:
    limits:
      memory: 512Mi
    requests:
      cpu: 10m
      memory: 128Mi

  autoscaling:
    enabled: false
    minReplicas: 3
    maxReplicas: 5
    targetCPUUtilizationPercentage: 80

  networkPolicy:
    enabled: true
    ingress:
      enabled: true
      namespaceSelector:
        network.openshift.io/policy-group: ingress

  ingress:
    enabled: true
    annotations:
      route.openshift.io/termination: edge

  acapy:
    nameOverride: agent
    image:
      pullPolicy: IfNotPresent

    # prod URLs (update if needed)
    agentUrl: "https://vc-authn-oidc-agent.apps.silver.devops.gov.bc.ca"
    adminUrl: "https://vc-authn-oidc-agent-admin.apps.silver.devops.gov.bc.ca"

    secrets:
      api:
        existingSecret: "vc-authn-oidc-agent-api"
      seed:
        existingSecret: "vc-authn-oidc-agent"

    walletStorageConfig:
      url: vc-authn-oidc-agent-database-primary:5432
    walletStorageCredentials:
      admin_account: walletman
      existingSecret: "vc-authn-oidc-agent-database"
      secretKeys:
        adminPasswordKey: admin-password
        userPasswordKey: acapy-password

    autoscaling:
      enabled: true
      minReplicas: 3
      maxReplicas: 5
      targetCPUUtilizationPercentage: 80
      stabilizationWindowSeconds: 0

    argfile.yml:
      admin-insecure-mode: false
      auto-accept-invites: true
      auto-accept-requests: true
      auto-ping-connection: true
      auto-provision: true
      auto-respond-credential-offer: true
      auto-respond-messages: true
      auto-verify-presentation: true
      genesis-transactions-list: /tmp/ledgers.yml
      log-level: info
      monitor-ping: true
      multitenant-admin: false
      multitenant: false
      public-invites: true
      read-only-ledger: true
      wallet-name: askar-wallet
      wallet-storage-type: postgres_storage
      wallet-type: askar
      webhook-url: https://vc-authn-oidc.apps.silver.devops.gov.bc.ca/webhooks

    ledgers.yml:
      - id: BCovrinTest
        is_production: true
        genesis_url: "http://test.bcovrin.vonx.io/genesis"
      - id: CANdyProd
        is_production: true
        is_write: true
        genesis_url: "https://raw.githubusercontent.com/ICCS-ISAC/dtrust-reconu/main/CANdy/prod/pool_transactions_genesis"
    networkPolicy:
      enabled: true
      ingress:
        enabled: true
        namespaceSelector:
          network.openshift.io/policy-group: ingress

    postgresql:
      enabled: false

  mongodb:
    image:
      registry: artifacts.developer.gov.bc.ca
      repository: docker-remote/bitnamilegacy/mongodb
      tag: 8.0.4-debian-12-r4
      pullPolicy: IfNotPresent
    auth:
      existingSecret: "vc-authn-oidc-mongodb"
    persistence:
      storageClass: netapp-block-standard
    resources:
      limits:
        memory: 1000Mi
      requests:
        cpu: 400m
        memory: 450Mi
    metrics:
      enabled: true
    readinessProbe:
      enabled: true
      timeoutSeconds: 10
    livenessProbe:
      enabled: true
      timeoutSeconds: 10
